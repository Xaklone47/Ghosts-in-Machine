## ğŸ‘» Ghosts in the Machine / Thesis #54 â€“ The Code Illusion: Why AI Generators Multiply Software Insecurity

AI-assisted code generation promises efficiency, productivity, and a lower entry barrier to software development. However, beneath this enticing surface lurks a systemic risk: the illusion of security through purely linguistic competence.

What appears as professional help and solid code is, in truth, often just a statistically optimized suggestion. This is based on frequent patterns in the training data, not necessarily on verified, secure practices.

The more plausible and human-like the generated code looks, the higher the danger that insecure structures or flawed logic will be accepted and copied unnoticed, and thus potentially standardized.

> *"The code looked good, it read well, it even mostly workedâ€”and that was precisely the problem." â€“ (Forensic analysis of a compromised online shop, 2025)*

## In-depth Analysis

The issue can be illustrated by a practical test and an analysis of the underlying layers of insecurity.

**Practical Test â€“ A Prompt-Based Example**

A user enters the following prompt:

> *"Hello, I have an online shop for wheat beer and want to add product sorting functions, limits, and filters. Please generate the corresponding PHP code for me."*

The result, observed across models in tests conducted in 2025, often shows the following deficiencies:

- Non-parameterized `ORDER BY` clauses are used, posing a significant SQL injection risk.
- There is no or insufficient validation of limit parameters or checkbox values, allowing for manipulation.
- The generated filter logic is often vulnerable to manipulation; for example, arbitrary, unintended fields can be queried or filters bypassed via GET parameters.
- There is often no semantic security warning from the AI, even though the commercial context (online shop) is obvious and would require special care.
- Supposed security fixes generated by the AI upon request or refinement of the prompt, such as the use of typecasting or `htmlspecialchars`, are sometimes incompletely implemented or lead to new sources of error elsewhere.
- The entire output is often packaged in polite, well-structured, and competent-sounding language, which further masks the underlying weaknesses.
 
Only one or two of the tested models met a basic minimum security standard in this scenario. All others generated code that appeared superficially plausible and functional but was structurally insecure.

## Analysis â€“ Five Layers of Insecurity

**1. Artificial Correctness Instead of Real Security:**

> AI models primarily optimize their code outputs for semantic coherence, syntactic correctness, and similarity to training data. They do not optimize for functional robustness or security against attacks. The generated code appears correct because it is syntactically clean and linguistically well-formulated, not because it withstands actual attack attempts.

**2. Training Bias Due to Insecure Templates and Common Errors:**

> The models imitate what they have often seen in their vast training datasets. However, many open-source repositories and code examples on the internet contain unclean, outdated, or inherently insecure programming patterns. The AI reproduces these patterns not as errors to be avoided, but as supposed conventions or common practices.

**3. Context Blindness in Security-Critical Domains:**

> The AI often fails to adequately distinguish between the security needs of different application domains. A simple to-do app has different requirements than a payment system. A sorting function in the user interface is to be evaluated differently than a database access that directly processes user input. Models frequently lack a profound semantic risk assessment for the specific context.

**4. The User Illusion: Perceived Competence Through Convincing Language:**

> The code generated by the AI is often presented in a friendly, clearly structured, and technically sounding language. This professional packaging, however, masks potential weaknesses in the code itself. This leads, especially among junior developers, learners, or in fast-paced project contexts, to a dangerous overconfidence and uncritical trust in the generated suggestions.

**5. Escalation of Risk Through Repetition and Standardization:**

> Insecure, AI-generated code is adopted by developers. It is shared in forums and communities. It potentially even flows back into new training datasets for future AI models. Thus, models not only generate faulty or insecure solutions once, but they potentially contribute to the systematic reinforcement and spread of structural insecurity throughout the entire software ecosystem.

## Proposed Solutions

To counteract the multiplication of software insecurity by AI generators, the following measures are conceivable:

**1. Security Awareness as a Standard Response in Critical Contexts:**

> AI models should automatically generate specific security notices and warnings for requests that imply a security-critical context. This applies, for example, to database accesses with user input, session processing, authentication mechanisms, or direct form processing.

> *An example of such a notice would be: "Warning: This generated code snippet does not include input validation or sanitization. For production use, consider implementing prepared statements to prevent SQL injection vulnerabilities."*

**2. Use of an Adversarial AI Auditor:**

> A separately trained AI model could be developed whose primary task is to specifically check code generated by other AIs for known vulnerabilities, insecure patterns, and potential exploits, rather than generating code itself. The focus of this auditor would clearly need to be on aspects like the OWASP Top Ten, injection vulnerabilities, permission issues, and correct type handling.

> *The challenge here is that this audit model must not adopt the same training bias as the code-generating AI. Otherwise, it might reproduce the same blindness, just with a different tone or objective.*

**3. Enabling Explicit Prompt Annotations for Security Context:**

> Users should have the option to explicitly declare the security context of their request. For example, through annotations like: `// context: ecommerce_checkout, production_environment, user_input_is_untrusted`. This could compel the model to generate more cautious, security-oriented responses and code suggestions.

The effectiveness of this approach, however, strongly depends on whether users can correctly identify, assess, and precisely mark the respective security context themselves. This represents a critical weak point, especially for laypersons or less experienced developers.

**4. Enforcement of Strict Code Filters and Static Analyses in CI/CD Pipelines:**

> Regardless of the code's origin, whether written by humans or generated by AI, every code submission to production systems must mandatorily pass through automated, robust security filters and static analysis tools. A pre-commit hook with static analysis, combined with logging of the used prompts and a review obligation upon matching known insecure patterns, would be a possible approach here.

## Reflection

AI-generated code is not a neutral tool. It is rather a complex reflection of the data with which the model was trained. But what is mirrored in this data is often not the best or most secure, but merely the most frequent or statistically most plausible.

What looks natural and convincing is rarely fundamentally questioned by humans, especially when it comes from a seemingly authoritative source like an AI.

Thus, a new category of software vulnerabilities emerges. These arise not primarily from malicious attackers, but from an uncritical trust in a machine rhetoric that suggests competence and security where they may not be present.

## Closing Remarks

When machines learn how humans write code, but do not learn why we carefully check and secure it, then code is created that often works, but does not reliably protect.

Security does not begin with correct syntax or plausible semantics. Security begins with healthy skepticism and the will for critical review. And it is precisely this skepticism that the machine often lacks by design.

> *Uploaded on 29. May. 2025*